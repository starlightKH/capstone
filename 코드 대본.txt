

코드에 대한 설명을 드리겠습니다.

AI를 학습시키기 위해서, 노이즈와 위험음을 적절하게 섞을 필요가 있었습니다
떄문에 기본 일상생활의 소리파일과 경적소리등의 위험 소리파일을 AI가 학습할 수 있도록 생성해주는
코드를 github에서 찾았고, 만들어진 소리파일의 파형을 볼 수 있게 추가 작업을 했습니다.

사용하는 모듈로서는 대표적으로 argparse와 numpy,librosa가 있습니다

argparse를 통해 코드를 실행할때, 코드의 실행 커맨드에서 음성파일의 위치를 작성함으로써 코드내의 변환없이 실행시킬 수 있었습니다.

numpy와 librosa는 연산을 위한 라이브러리 입니다.

첫번째 함수 get_args에서는 믹싱할 파일과 snr값을 지정 및 객체를 생성하는 함수입니다.

cal_adjusted_rms는 사용자에게서 입력받을 snr값을 이용해 노이즈파일의 rms를 계산합니다.

cal_amp에서는 오디오파일의 프레임을 읽고 파일의 진폭를 float64로써 반환합니다

cal_rms에서 rms값을 계산합니다

save_waveform에서 위의 get_args에서 받았던 값을 기본으로 파일의 저장위치를 설정한다.

main함수입니다.

먼저 나중에 나올 wav파일의 그래프의 크기를 선언한 다음

get_args함수를 불러와 실행할때 입력한 값을 각각의 객체에 저장합니다.

그 후 두 소리파일을 분석합니다.

일상생활 소리파일의 길이가 위험소리보다 길기 때문에, 긴 파일의 소리를 짧은 파일을 기준으로 랜덤하게 자른 후 rms를 다시 구합니다.

snr을 사용자의 입력한 값으로 불러오고 이를 바탕으로 rms값을 구합니다.

두 소리객체를 합칩니다.

이때 합친 두소리의 최대값이 int16의 최대값을 넘어가 버리면 절단현상이 일어나므로 파일을 정규화합니다.

만들어진 파일을 저장합니다.

경적소리와 같은 위험소리의 경우 파형에서 큰 편차를 보일 수 있기때문에 
추가적으로 librosa모듈을 사용해 시간에 따른 진폭을 볼 수 있게 했습니다.